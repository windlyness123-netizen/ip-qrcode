<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPå½’å±åœ°åˆ¤æ–­ (æ±Ÿè‹å—äº¬/éæ±Ÿè‹å—äº¬)</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
        }
        body {
            background: linear-gradient(145deg, #eef2f6 0%, #d3dee9 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        .card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 40px;
            box-shadow: 0 20px 36px -12px rgba(0, 30, 60, 0.4);
            width: 100%;
            max-width: 640px;
            padding: 32px 28px;
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 8px;
            color: #0b2b42;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        h1 span {
            background: #1e6f9f;
            color: white;
            font-size: 0.8rem;
            padding: 4px 12px;
            border-radius: 40px;
            font-weight: 500;
        }
        .sub {
            color: #2c4b66;
            margin-bottom: 28px;
            font-size: 1rem;
            border-left: 4px solid #3b8fc2;
            padding-left: 16px;
            background: rgba(59, 143, 194, 0.08);
            border-radius: 0 12px 12px 0;
            line-height: 1.5;
        }
        .info-panel {
            background: #ffffffd9;
            border-radius: 32px;
            padding: 24px;
            box-shadow: inset 0 1px 4px rgba(255,255,255,0.9), 0 8px 18px rgba(0,20,40,0.12);
            margin: 24px 0;
            border: 1px solid rgba(255,255,255,0.8);
        }
        .info-row {
            display: flex;
            align-items: flex-start;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }
        .info-label {
            width: 100px;
            font-weight: 600;
            color: #0a3b5c;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }
        .info-value {
            flex: 1;
            font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
            background: #ecf3fa;
            padding: 8px 16px;
            border-radius: 40px;
            color: #0b2b42;
            border: 1px solid #b9d0e6;
            word-break: break-word;
        }
        /* ç‰¹æ®Šå¼ºè°ƒ */
        #locationJudge {
            font-weight: 700;
            background: #faeec2;
            color: #a5550e;
            border-color: #e5b55c;
        }
        .info-value#locationDisplay {
            font-size: 1.2rem;
            font-weight: 600;
            background: #d2e6ff;
            color: #004070;
        }
        button {
            background: #0f4c75;
            border: none;
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 16px 28px;
            border-radius: 60px;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 10px 20px -6px #0f4c75b3;
            border: 1px solid rgba(255,255,255,0.3);
            letter-spacing: 0.8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        button:hover {
            background: #0a3a5a;
            transform: scale(1.01);
            box-shadow: 0 16px 28px -6px #0a2e48;
        }
        button:active {
            transform: scale(0.98);
        }
        .footnote {
            font-size: 0.85rem;
            color: #3d637f;
            margin-top: 24px;
            text-align: center;
            background: #deeaf6cc;
            padding: 12px 20px;
            border-radius: 50px;
            border: 1px solid #ffffff;
        }
        .footnote code {
            background: #1d3d5c;
            color: #eaf2fd;
            padding: 2px 10px;
            border-radius: 24px;
            font-size: 0.8rem;
        }
        .loader {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .status {
            min-height: 32px;
            font-size: 0.95rem;
            margin-top: 16px;
            text-align: center;
        }
        .judge-highlight {
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>
            ğŸŒ IPå½’å±åœ°æŸ¥è¯¢ (å—äº¬åˆ¤æ–­)
            <span>API v2</span>
        </h1>

        <!-- æ˜¾ç¤ºç»“æœçš„åŒºåŸŸ -->
        <div class="info-panel" id="resultPanel">
            <div class="info-row">
                <div class="info-label">ğŸ“ ç»„åˆä½ç½®</div>
                <div class="info-value" id="locationDisplay">â€”</div>
            </div>
            <div class="info-row">
                <div class="info-label">ğŸ·ï¸ å½’å±åœ°åˆ¤æ–­</div>
                <div class="info-value" id="locationJudge">â€”</div>
            </div>
            <div class="info-row">
                <div class="info-label">ğŸ–¥ï¸ IP åœ°å€</div>
                <div class="info-value" id="ipDisplay">â€”</div>
            </div>
            <div class="info-row">
                <div class="info-label">ğŸ¢ ç»„ç»‡</div>
                <div class="info-value" id="orgDisplay">â€”</div>
            </div>
            <div class="info-row">
                <div class="info-label">ğŸŒ å›½å®¶/åœ°åŒº</div>
                <div class="info-value" id="countryDisplay">â€”</div>
            </div>
        </div>

        <!-- æŒ‰é’®å’ŒçŠ¶æ€ -->
        <button id="queryBtn">
            <span>ğŸ”</span> æŸ¥è¯¢æˆ‘çš„ä¿¡æ¯ <span id="btnLoader" style="display: none;"><span class="loader"></span></span>
        </button>

        <div class="status" id="statusMessage">
            âš¡ ç‚¹å‡»æŒ‰é’®å¼€å§‹æ£€æµ‹ (åˆ¤æ–­ä¾æ®: åŸå¸‚åæ˜¯å¦ä¸º Nanjing)
        </div>

        <!-- è”ç³»ä¿¡æ¯ (ä¿æŒä¸å˜) -->
        <div style="text-align: center; margin-top: 24px; font-size: 1rem; background: #deeaf6; padding: 14px 20px; border-radius: 60px; border: 1px solid rgba(255,255,255,0.9); color: #0f4c75; box-shadow: 0 4px 8px rgba(0,0,0,0.05);">
            ğŸ“¸ æˆªå›¾æœ¬é¡µé¢è”ç³»åœ¨çº¿å®¢æœ &nbsp;&nbsp; æ²¡å›å¤è¯·è‡´ç”µ <strong style="font-size: 1.3rem; color: #b13e3e;">18761662888</strong>
        </div>

    </div>

    <script>
        (function() {
            const btn = document.getElementById('queryBtn');
            const btnLoader = document.getElementById('btnLoader');
            const locationDisplay = document.getElementById('locationDisplay');
            const locationJudge = document.getElementById('locationJudge');
            const ipDisplay = document.getElementById('ipDisplay');
            const orgDisplay = document.getElementById('orgDisplay');
            const countryDisplay = document.getElementById('countryDisplay');
            const statusMsg = document.getElementById('statusMessage');

            function setLoading(isLoading) {
                if (isLoading) {
                    btnLoader.style.display = 'inline-block';
                    btn.disabled = true;
                    statusMsg.innerHTML = 'â³ è¯·æ±‚ä¸­ï¼Œè¯·ç¨å€™...';
                } else {
                    btnLoader.style.display = 'none';
                    btn.disabled = false;
                }
            }

            async function fetchGeoInfo() {
                setLoading(true);
                try {
                    // è°ƒç”¨ ip.sb API è·å–å½“å‰è®¿é—®è€…çš„ IP ä¿¡æ¯
                    const response = await fetch('https://api.ip.sb/geoip', {
                        headers: { 'Accept': 'application/json' }
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status} â€” ${response.statusText}`);
                    }

                    const data = await response.json();
                    console.log('APIå“åº”:', data);

                    // æå–å­—æ®µ
                    const city = data.city || 'æœªçŸ¥åŸå¸‚';
                    const country = data.country || 'æœªçŸ¥å›½å®¶';
                    const ip = data.ip || 'â€”';
                    const organization = data.organization || data.isp || 'æœªæä¾›';
                    const countryCode = data.country_code || '';

                    // ç»„åˆä½ç½® (åŸå¸‚ + å›½å®¶)
                    const locationStr = `${city} ${country}`.trim();

                    // ----- å½’å±åœ°åˆ¤æ–­é€»è¾‘ (æ ¹æ®å—äº¬) -----
                    // å¦‚æœåŸå¸‚ (å¿½ç•¥å¤§å°å†™) æ˜¯ 'nanjing' åˆ™æ˜¾ç¤º 'æ±Ÿè‹å—äº¬'ï¼Œå¦åˆ™æ˜¾ç¤º 'éæ±Ÿè‹å—äº¬å½’å±åœ°'
                    let judgeText = 'éæ±Ÿè‹å—äº¬å½’å±åœ°';  // é»˜è®¤
                    if (city && city.toLowerCase() === 'nanjing') {
                        judgeText = 'æ±Ÿè‹å—äº¬';
                    }
                    // -------------------------

                    // æ›´æ–°UI
                    locationDisplay.textContent = locationStr;
                    locationJudge.textContent = judgeText;
                    ipDisplay.textContent = ip;
                    orgDisplay.textContent = organization;
                    countryDisplay.textContent = `${country} (${countryCode})`;

                    statusMsg.innerHTML = 'âœ… æ•°æ®æ›´æ–°äº ' + new Date().toLocaleTimeString('zh-CN');
                } catch (error) {
                    console.error('APIè¯·æ±‚å¤±è´¥:', error);
                    statusMsg.innerHTML = `âŒ è¯·æ±‚å¤±è´¥: ${error.message}ã€‚å¯èƒ½ç½‘ç»œé—®é¢˜æˆ–APIé™åˆ¶ã€‚`;

                    // æ¸…ç©ºæ˜¾ç¤º
                    locationDisplay.textContent = 'â€”';
                    locationJudge.textContent = 'â€”';
                    ipDisplay.textContent = 'â€”';
                    orgDisplay.textContent = 'â€”';
                    countryDisplay.textContent = 'â€”';
                } finally {
                    setLoading(false);
                }
            }

            btn.addEventListener('click', fetchGeoInfo);

            // (å¯é€‰) é¡µé¢åŠ è½½åè‡ªåŠ¨æŸ¥è¯¢
            // fetchGeoInfo();
        })();
    </script>
</body>
</html>
